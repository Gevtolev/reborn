# Reborn App 设计文档

## 概述

基于 Dan Koe "一天重启人生"方法论的 AI 教练应用，通过智能 Agent 陪伴用户完成身份重塑和持续成长。

## 产品定位

**核心理念**：不是"目标打卡工具"，而是"身份重塑教练"。不只追踪用户做了什么，而是帮助用户成为那个自然会做这些事的人。

**三层价值主张**：

1. **即时价值** — 每天收到 Agent 的反思提问，打断无意识的"自动驾驶"模式
2. **短期价值** — 通过对话逐步挖掘出自己的愿景和反愿景，建立清晰方向
3. **长期价值** — Agent 记住用户的一切，成为真正理解你的成长伙伴

## 技术选型

| 层级 | 技术选择 |
|------|----------|
| 移动端 | React Native (iOS + Android) |
| Web端 | React |
| 后端框架 | Python + FastAPI |
| 数据库 | PostgreSQL + Redis |
| 向量数据库 | pgvector 或 Milvus（记忆检索） |
| AI 后端 | 国产大模型（通义千问/文心一言） |
| 部署 | 阿里云或腾讯云 |

## 用户旅程

### 阶段一：首次体验（第1天）

用户下载后无需填写复杂表单。Agent 直接发起对话："你好，我是你的成长伙伴。告诉我，最近有什么让你感到不满或想要改变的？"

首次对话约 5-10 分钟，Agent 初步了解用户现状，并设置第一个每日提醒。用户立即感受到价值。

### 阶段二：逐步深化（第1-2周）

Agent 每天在随机时间推送反思问题（来自 Dan Koe 问题库），如"你现在做这件事是在逃避什么？"

在自然对话中，Agent 逐步引导用户完成心理挖掘：反愿景 → 愿景 → 身份声明 → 目标设定。不强迫，在用户准备好时推进。

### 阶段三：稳定使用（长期）

用户已建立愿景和目标。Agent 转为日常陪伴模式：全天随机提醒、可选的晨间/晚间固定提醒。仪表盘展示进度和连续天数。

## Agent 系统设计

### 人格设定

智慧且直接的教练风格，参考 Dan Koe 本人：不迎合、不说空话、直指问题本质，但始终支持用户成长。会适度挑战用户的借口和自我欺骗。

### 核心能力

1. **记忆系统** — 记住用户的愿景、反愿景、身份声明、过往对话要点。每次对话都能引用之前的内容。

2. **主动触达** — 在用户设定的时间范围内随机推送问题，每天时间不同，打断自动驾驶模式。

3. **对话引导** — 识别用户当前状态（迷茫、逃避、有进展、遇到困难），采用不同对话策略。

4. **阶段感知** — 知道用户处于旅程哪个阶段（新用户、正在挖掘、已有愿景），自动调整交互方式。

### Prompt 工程

为 Agent 设计系统提示词，注入：
- Dan Koe 的方法论框架
- 反思问题库
- 人格特征
- 动态插入用户个人数据（愿景、目标等）

## 数据模型

```
User（用户）
├── id, phone, email, created_at
├── subscription_tier (预留字段)
└── settings (提醒时间范围、语音偏好等)

Profile（用户画像 - Agent 记忆核心）
├── anti_vision      # 反愿景：不想成为的样子
├── vision           # 愿景：理想生活描述
├── identity_statement # 身份声明："我是那种...的人"
├── current_stage    # 当前阶段（新用户/挖掘中/已建立愿景）
└── key_insights     # 关键洞察摘要（JSON数组）

Goal（目标）
├── type (yearly/monthly/daily)
├── content          # 目标内容
├── status (active/completed/abandoned)
└── linked_to        # 关联上级目标

Conversation（对话记录）
├── messages         # 对话消息数组
├── summary          # AI生成的对话摘要
└── extracted_insights # 从对话中提取的洞察

Progress（进度追踪）
├── streak_days      # 连续天数
├── total_reflections # 总反思次数
└── milestones       # 已达成里程碑
```

## 记忆管理机制

### 三层记忆架构

**核心记忆（永久保留，约500字以内）**
- 反愿景、愿景、身份声明
- 最重要的 3-5 个人生洞察
- 关键转折点事件

**长期记忆（压缩存储）**
- 每周/每月对话摘要（AI 自动生成）
- 目标完成记录
- 重要情绪波动事件

**短期记忆（滚动窗口）**
- 最近 7 天的对话详情
- 当前进行中的目标上下文

### 智能检索

使用向量数据库存储所有记忆。每次对话时：
1. 核心记忆 → 始终注入
2. 短期记忆 → 始终注入
3. 长期记忆 → 根据当前话题语义检索最相关的 3-5 条

### 定期压缩

每周自动将该周对话压缩成摘要（约 100-200 字），原始对话可选择性保留或删除。用户可手动标记"重要对话"永久保留。

## 提醒系统设计

### 随机提醒（核心）

- 用户设置时间范围（如 9:00-21:00）
- 系统在范围内随机选择推送时间
- 每天时间不同，避免形成新的自动驾驶模式
- 问题从 Dan Koe 问题库随机选择

### 固定提醒（可选补充）

- 用户可额外设置固定时间提醒
- 如晨间问候、晚间复盘
- 作为随机提醒的补充

### 技术实现

每天凌晨为用户生成当日随机推送时间队列，存入 Redis，到点触发推送。

## 功能模块

```
模块1：对话引擎
├── 文字对话
├── 语音输入
└── 流式响应

模块2：提醒系统
├── 随机时间推送
├── 可选固定提醒
└── 智能问题选择

模块3：仪表盘
├── 愿景/反愿景展示
├── 当前目标
├── 进度追踪
└── 连续天数

模块4：记忆中心
├── 核心记忆管理
├── 对话历史
└── 洞察回顾

模块5：设置中心
├── 提醒时间范围
├── 语音偏好
└── 数据管理
```

## MVP 开发优先级

### P0（必须有）

1. 用户注册/登录（手机号验证码）
2. Agent 对话（文字，流式响应）
3. 首次引导对话（Agent 主动开场）
4. 核心记忆存储（愿景、反愿景、身份声明）
5. 基础仪表盘（展示愿景、当前目标）
6. 每日随机提醒推送（Dan Koe 问题库）

### P1（体验增强）

1. 自定义提醒时间范围
2. 对话历史查看
3. 连续天数追踪
4. 语音输入
5. 目标设置与追踪（年/月/日）

### P2（后续迭代）

1. 智能问题选择（根据用户状态）
2. 记忆压缩与向量检索
3. 语音回复
4. 成长报告
5. Web 端

## 商业模式

MVP 阶段全部免费，先积累用户。后续可考虑的付费点：
- 深度分析报告（AI 生成的周报/月报）
- 数据导出
- 高级 Agent 人格选择
- 或走增值服务/广告路线

## 项目结构（建议）

```
reborn/
├── mobile/                 # React Native 移动端
│   ├── src/
│   │   ├── screens/
│   │   ├── components/
│   │   ├── services/
│   │   └── stores/
│   └── package.json
│
├── web/                    # React Web 端（P2）
│   └── ...
│
├── backend/                # FastAPI 后端
│   ├── app/
│   │   ├── api/           # 路由
│   │   ├── services/      # 业务逻辑
│   │   ├── models/        # 数据模型
│   │   ├── ai/            # 大模型调用封装
│   │   └── core/          # 配置、依赖
│   ├── requirements.txt
│   └── main.py
│
├── shared/                 # 共享代码（类型定义等）
│
└── docs/
    └── plans/
```

## 参考资料

- Dan Koe《How to fix your entire life in 1 day》
- 控制论与目的论思想
- 马斯洛需求层次理论
- 心流理论（米哈里·契克森米哈赖）
